# 组件

前端中的组件是一堆为了实现同一业务逻辑的代码文件的组合，将相关文件都放到同一个目录中，就形成了一个独立性非常强的组件。

Angular 中使用了Web Component 的标准来实现组件化：[Web Component](../前端进阶/WebComponent/README.md)

组件是 Angular 应用的最小的逻辑单元，模块则是在组件之上的一层抽象。组件以及其他部分，如指令、管道、服务、路由等都可以被包含到一个模块中，外部通过引用这个模块来使用一系列封装好的功能。

可以把 Angular 应用想象成一棵树，模块是这棵树的树枝，组件是这棵树的叶子，每个 Angular 应用都必须要有一个根模块（树干），并且根模块中必须通过 Bootstrap 指定根组件，用于启动 Angular 应用。

## 创建组件 

创建组件跟简单，可以通过一下三个步骤创建组件：

1. 从 `@angular/core` 中引入 `Component` 装饰器;
2. 建立一个普通的类，并用 `@Component` 修饰它;
3. 在 `@Component` 中，设置 `selector` 自定义标签和 `template/templateUrl` 模板以及 `styles/styleUrls` 样式。

```ts
import { Component } from '@angular/core';

@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent { }
```

> 在新版的 Angular 中自定义标签需要以 `app-` 开头，否则会报错。

以上代码会创建一个最简单的 Angular 组件，使用这个组件需要在 HTML 中添加 `<app-root></app-root>` 标签，然后 Angular 便会在此标签中插入组件中指定的模板。

## 组件的基础构成

组件由组件装饰器、组件元数据、模板和组件类组成。

### 组件装饰器( Component Decorator )

每个组件类必须使用 `@Component` 进行修饰才能成为 Angular 组件; `@Component` 是 TypeScript 的语法，它是一个装饰器，任何一个 Angular 的组件都会用这个装饰器修饰，如果移除了这个装饰器，它将不再是 Angular 组件了。

### 组件元数据

在组件中的 `@Component` 装饰器部分，提供了额外的元数据以确定如何在运行时处理、实例化和使用组件：

* selector：用于定义组件标签名，也是此组件的元素选择器;
* template：定义组件宿主元素的模板;
* templateUrl：引用外联模板;
* styles：要应用于此组件视图的内联定义样式;
* styleUrls：要应用于此组件视图的外联样式表;
* animations：此组件的动画列表;
* providers：此组件及其子组件可用的 `providers` 列表;
* viewProviders：此组件及其视图子项可用的 `providers` 列表;
* exportAs：在模板中导出组件实例的名称;
* inputs：以数据绑定为组件输入类属性名称列表;
* moduleId：定义此组件的 ES/CommonJS 模块 ID;
* outputs：显示其他人可以订阅的输出事件的类属性名称列表;
* host：将类属性映射到元素绑定的事件和属性;
* encapsulation：此组件使用的样式封装策略;
* interpolation：在此组件模板中使用的自定义插值标记;
* queries：配置可以注入组件的查询;
* changeDetection： 更改此组件使用的检测策略.

每个组件只能指定一个模板，可以使用 `template` 或者 `templateUrl` 的引入方式。

`styles` 和 `styleUrls` 允许同时指定。如果同时指定，`styles` 中的样式会先被解析，然后才会解析 `styleUrls` 中的样式。

### 模板

每个组件都会关联一个模板，这个模板最终会渲染到页面上，页面的这个 DOM 元素就是此组件实例的宿主元素;

组件是自描述的。可以与宿主元素交互，交互的形式包括：

* 显示数据

可以再模板中使用插值语法 `{{}}` 来显示组件中的数据。

* 双向数据绑定

在模板中通过形如 `[(ngModel)]='property'` 的方式进行双向数据绑定。

* 监听宿主元素事件以及调用组件方法

在模板中通过形如 `(click)='fun()'` 的方法响应 UI 事件并调用组件中的方法。

### 组件类

组件实际上也是一个普通的类，组件的逻辑都在组件类里定义并实现。